{"ast":null,"code":"import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';\nconst todosApi = createApi({\n  reducerPath: 'todosApi',\n  baseQuery: fetchBaseQuery({\n    baseUrl: 'https://todo-list-backend-nvp1.onrender.com',\n    prepareHeaders: (headers, {\n      getState\n    }) => {\n      // Get the token from the auth state (you can also use localStorage here)\n      const token = getState().auth.token || localStorage.getItem('token');\n      if (token) {\n        headers.set('Authorization', `Bearer ${token}`);\n      }\n      return headers;\n    }\n  }),\n  tagTypes: ['Todo'],\n  endpoints: builder => ({\n    fetchTodos: builder.query({\n      query: () => {\n        const userId = localStorage.getItem('userId'); // Fetch userId from localStorage\n        return `/api/todos?userId=${userId}`; // Send userId as query param\n      },\n      providesTags: result => result ? [...result.map(({\n        id\n      }) => ({\n        type: 'Todo',\n        id\n      })), {\n        type: 'Todo',\n        id: 'LIST'\n      }] : [{\n        type: 'Todo',\n        id: 'LIST'\n      }]\n    }),\n    addTodo: builder.mutation({\n      query: newTodo => ({\n        url: '/api/todos',\n        method: 'POST',\n        body: newTodo\n      }),\n      invalidatesTags: [{\n        type: 'Todo',\n        id: 'LIST'\n      }]\n    })\n  })\n});\nexport const {\n  useFetchTodosQuery,\n  useAddTodoMutation\n} = todosApi;\nexport default todosApi;","map":{"version":3,"names":["createApi","fetchBaseQuery","todosApi","reducerPath","baseQuery","baseUrl","prepareHeaders","headers","getState","token","auth","localStorage","getItem","set","tagTypes","endpoints","builder","fetchTodos","query","userId","providesTags","result","map","id","type","addTodo","mutation","newTodo","url","method","body","invalidatesTags","useFetchTodosQuery","useAddTodoMutation"],"sources":["/Users/anbschool0021/Documents/Backend-frontend/frontend/src/store/apis/todosApi.js"],"sourcesContent":["import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';\n\nconst todosApi = createApi({\n  reducerPath: 'todosApi',\n  baseQuery: fetchBaseQuery({\n    baseUrl: 'https://todo-list-backend-nvp1.onrender.com',\n    prepareHeaders: (headers, { getState }) => {\n        // Get the token from the auth state (you can also use localStorage here)\n        const token = getState().auth.token || localStorage.getItem('token');\n        if (token) {\n          headers.set('Authorization', `Bearer ${token}`);\n        }\n        return headers;\n      },\n  }),\n  tagTypes: ['Todo'],\n  endpoints: (builder) => ({\n    fetchTodos: builder.query({\n      query: () => {\n        const userId = localStorage.getItem('userId'); // Fetch userId from localStorage\n        return `/api/todos?userId=${userId}`; // Send userId as query param\n      },\n      providesTags: (result) =>\n        result\n          ? [...result.map(({ id }) => ({ type: 'Todo', id })), { type: 'Todo', id: 'LIST' }]\n          : [{ type: 'Todo', id: 'LIST' }],\n    }),\n      \n    addTodo: builder.mutation({\n      query: (newTodo) => ({\n        url: '/api/todos',\n        method: 'POST',\n        body: newTodo,\n      }),\n      invalidatesTags: [{ type: 'Todo', id: 'LIST' }],\n    }),\n  }),\n});\n\nexport const { useFetchTodosQuery, useAddTodoMutation } = todosApi;\nexport default todosApi;\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,cAAc,QAAQ,8BAA8B;AAExE,MAAMC,QAAQ,GAAGF,SAAS,CAAC;EACzBG,WAAW,EAAE,UAAU;EACvBC,SAAS,EAAEH,cAAc,CAAC;IACxBI,OAAO,EAAE,6CAA6C;IACtDC,cAAc,EAAEA,CAACC,OAAO,EAAE;MAAEC;IAAS,CAAC,KAAK;MACvC;MACA,MAAMC,KAAK,GAAGD,QAAQ,CAAC,CAAC,CAACE,IAAI,CAACD,KAAK,IAAIE,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MACpE,IAAIH,KAAK,EAAE;QACTF,OAAO,CAACM,GAAG,CAAC,eAAe,EAAE,UAAUJ,KAAK,EAAE,CAAC;MACjD;MACA,OAAOF,OAAO;IAChB;EACJ,CAAC,CAAC;EACFO,QAAQ,EAAE,CAAC,MAAM,CAAC;EAClBC,SAAS,EAAGC,OAAO,KAAM;IACvBC,UAAU,EAAED,OAAO,CAACE,KAAK,CAAC;MACxBA,KAAK,EAAEA,CAAA,KAAM;QACX,MAAMC,MAAM,GAAGR,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC/C,OAAO,qBAAqBO,MAAM,EAAE,CAAC,CAAC;MACxC,CAAC;MACDC,YAAY,EAAGC,MAAM,IACnBA,MAAM,GACF,CAAC,GAAGA,MAAM,CAACC,GAAG,CAAC,CAAC;QAAEC;MAAG,CAAC,MAAM;QAAEC,IAAI,EAAE,MAAM;QAAED;MAAG,CAAC,CAAC,CAAC,EAAE;QAAEC,IAAI,EAAE,MAAM;QAAED,EAAE,EAAE;MAAO,CAAC,CAAC,GACjF,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAED,EAAE,EAAE;MAAO,CAAC;IACrC,CAAC,CAAC;IAEFE,OAAO,EAAET,OAAO,CAACU,QAAQ,CAAC;MACxBR,KAAK,EAAGS,OAAO,KAAM;QACnBC,GAAG,EAAE,YAAY;QACjBC,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEH;MACR,CAAC,CAAC;MACFI,eAAe,EAAE,CAAC;QAAEP,IAAI,EAAE,MAAM;QAAED,EAAE,EAAE;MAAO,CAAC;IAChD,CAAC;EACH,CAAC;AACH,CAAC,CAAC;AAEF,OAAO,MAAM;EAAES,kBAAkB;EAAEC;AAAmB,CAAC,GAAG/B,QAAQ;AAClE,eAAeA,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}